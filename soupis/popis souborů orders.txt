# ğŸ“‹ MODUL ZAKÃZKY - KOMPLETNÃ POPIS SOUBORÅ®

---

## ğŸ“ STRUKTURA MODULU

```
modules/orders/
â”œâ”€â”€ __init__.py                    # Inicializace modulu
â”œâ”€â”€ module_orders.py               # HlavnÃ­ vstupnÃ­ bod - seznam zakÃ¡zek
â”œâ”€â”€ order_form.py                  # Dialog pro vytvoÅ™enÃ­/editaci zakÃ¡zky
â”œâ”€â”€ order_detail.py                # Detail zakÃ¡zky - kompletnÃ­ okno
â”œâ”€â”€ order_items.py                 # SprÃ¡va poloÅ¾ek zakÃ¡zky (dÃ­ly, prÃ¡ce, ostatnÃ­)
â”œâ”€â”€ order_widgets.py               # PomocnÃ© dialogy a widgety
â”œâ”€â”€ order_export.py                # Export do PDF (zakÃ¡zkovÃ½ list, proforma, faktura)
â”œâ”€â”€ order_analytics.py             # AnalÃ½zy a statistiky zakÃ¡zek
â”œâ”€â”€ order_preview.py               # NÃ¡hled dokumentÅ¯ pÅ™ed tiskem
â”œâ”€â”€ order_work_order_editor.py     # Editor zakÃ¡zkovÃ©ho listu
â””â”€â”€ order_work_order_preview.py    # NÃ¡hled zakÃ¡zkovÃ©ho listu
```

---

### **1. `__init__.py`** ğŸ“¦

**ÃšÄel:** InicializaÄnÃ­ soubor modulu

**Obsahuje:**
```python
from .module_orders import OrdersModule
from .order_form import OrderFormDialog
from .order_detail import OrderDetailWindow

__all__ = ['OrdersModule', 'OrderFormDialog', 'OrderDetailWindow']
```

---

### **2. `module_orders.py`** â­ HLAVNÃ SOUBOR

**ÃšÄel:** HlavnÃ­ vstupnÃ­ bod modulu - seznam vÅ¡ech zakÃ¡zek

**Obsahuje:**

**HlaviÄka:**
- Titulek "ğŸ“‹ ZakÃ¡zky"
- TlaÄÃ­tka pro rychlÃ© vytvoÅ™enÃ­:
  - â• NovÃ¡ zakÃ¡zka (zelenÃ¡)
  - â• VolnÃ½ prodej (modrÃ¡)
  - â• NabÃ­dka (oranÅ¾ovÃ¡)

**RychlÃ½ pÅ™ehled (statistiky):**
- ğŸ“Š Celkem zakÃ¡zek
- â³ V pÅ™Ã­pravÄ›
- ğŸ“‚ OtevÅ™enÃ¡
- ğŸ”§ RozpracovanÃ¡

**Filtry:**
- ğŸ” VyhledÃ¡vÃ¡nÃ­ (ÄÃ­slo, zÃ¡kaznÃ­k, motorka)
- Typ zakÃ¡zky (VÅ¡e, ZakÃ¡zka, VolnÃ½ prodej, NabÃ­dka, Garance, Reklamace)
- Stav zakÃ¡zky (VÅ¡e, V pÅ™Ã­pravÄ›, OtevÅ™enÃ¡, RozpracovanÃ¡, ÄŒekÃ¡ na dÃ­ly, HotovÃ¡, Archiv)
- ğŸ”„ TlaÄÃ­tko Reset filtrÅ¯

**Tabulka zakÃ¡zek:**
- ÄŒÃ­slo zakÃ¡zky
- Typ
- Stav (barevnÄ› odliÅ¡enÃ½ badge)
- ZÃ¡kaznÃ­k
- Motorka (znaÄka model SPZ)
- Datum vytvoÅ™enÃ­
- Datum dokonÄenÃ­
- Cena celkem (KÄ)
- PoznÃ¡mka (zkrÃ¡cenÃ¡ na 50 znakÅ¯)
- ID (skrytÃ©)

**KontextovÃ© menu (pravÃ½ klik):**
- ğŸ“– OtevÅ™Ã­t detail
- âœï¸ Upravit
- ğŸ“‹ KopÃ­rovat ÄÃ­slo zakÃ¡zky
- ğŸ”„ ZmÄ›nit stav (submenu se vÅ¡emi stavy)
- ğŸ—‘ï¸ Smazat

**Funkce:**
- Dvojklik otevÅ™e detail zakÃ¡zky
- AutomatickÃ© naÄÃ­tÃ¡nÃ­ a filtrovÃ¡nÃ­
- KopÃ­rovÃ¡nÃ­ ÄÃ­sla zakÃ¡zky do schrÃ¡nky
- RychlÃ¡ zmÄ›na stavu
- SprÃ¡va vÃ­ce otevÅ™enÃ½ch oken detailÅ¯

---

### **3. `order_form.py`** ğŸ“

**ÃšÄel:** Dialog pro vytvoÅ™enÃ­ nebo editaci zakÃ¡zky

**Obsahuje:**

**FormulÃ¡Å™:**
- Typ zakÃ¡zky (ComboBox: ZakÃ¡zka, VolnÃ½ prodej, NabÃ­dka, Garance, Reklamace)
- Stav (ComboBox: V pÅ™Ã­pravÄ›, OtevÅ™enÃ¡, RozpracovanÃ¡, ÄŒekÃ¡ na dÃ­ly, HotovÃ¡, Archiv)
- SPZ motorky * (input + tlaÄÃ­tko ğŸ” Vyhledat)
- Info o motorce (automaticky naÄteno, read-only, zelenÃ½ box)
- Info o zÃ¡kaznÃ­kovi (automaticky naÄteno, read-only, zelenÃ½ box)
- PoznÃ¡mka k zakÃ¡zce (TextEdit)

**Funkcionalita:**
- AutomatickÃ½ pÅ™evod SPZ na velkÃ¡ pÃ­smena
- VyhledÃ¡nÃ­ motorky podle SPZ
- Pokud motorka neexistuje â†’ nabÃ­dka vytvoÅ™enÃ­ novÃ©
- AutomatickÃ© naÄtenÃ­ zÃ¡kaznÃ­ka z motorky
- VarovÃ¡nÃ­ pokud motorka nemÃ¡ zÃ¡kaznÃ­ka
- GenerovÃ¡nÃ­ ÄÃ­sla zakÃ¡zky (formÃ¡t: ROK + poÅ™adovÃ© ÄÃ­slo, napÅ™. 20250001)

**Validace:**
- Kontrola zda je vybrÃ¡na motorka
- Kontrola zda motorka mÃ¡ zÃ¡kaznÃ­ka

**TlaÄÃ­tka:**
- ZruÅ¡it
- UloÅ¾it (zelenÃ©)

---

### **4. `order_detail.py`** ğŸ“Š DETAIL ZAKÃZKY

**ÃšÄel:** KompletnÃ­ okno s detailem zakÃ¡zky - profesionÃ¡lnÃ­ verze

**Obsahuje:**

**HornÃ­ akÄnÃ­ liÅ¡ta (45px, kompaktnÃ­):**
- ÄŒÃ­slo zakÃ¡zky (napÅ™. "ZakÃ¡zka Ä. 20250001")
- Badge stavu (barevnÃ½, zaoblenÃ½)
- AktuÃ¡lnÃ­ cena (zelenÃ¡, vÃ½raznÃ¡)
- TlaÄÃ­tko "ZmÄ›nit stav" (modrÃ©)
- TlaÄÃ­tko "âœ“ UloÅ¾it" (zelenÃ©)
- TlaÄÃ­tko "âœ• Smazat" (ÄervenÃ©)

**HlavnÃ­ obsah - Split View (70:30):**

**LEVÃ PANEL - ZÃ¡loÅ¾ky:**

ğŸ“‹ **ZÃ¡loÅ¾ka 1: ZÃ¡kladnÃ­ informace**
- **ZÃ¡kaznÃ­k:**
  - JmÃ©no a pÅ™Ã­jmenÃ­ (proklik na detail zÃ¡kaznÃ­ka)
  - Telefon, email
  - Adresa

- **FakturaÄnÃ­ Ãºdaje:**
  - Checkbox "JinÃ© fakturaÄnÃ­ Ãºdaje"
  - NÃ¡zev firmy / JmÃ©no pro fakturu
  - IÄŒO
  - FakturaÄnÃ­ adresa

- **Motorka:**
  - ZnaÄka Model (SPZ) (proklik na detail motorky)
  - VIN

- **PoznÃ¡mky:**
  - PoznÃ¡mka k zakÃ¡zce (editovatelnÃ¡)
  - PoznÃ¡mky z motorky (read-only)
  - PoznÃ¡mky ze zÃ¡kaznÃ­ka (read-only)

ğŸ“¦ **ZÃ¡loÅ¾ka 2: PoloÅ¾ky zakÃ¡zky**
- TÅ™i podzÃ¡loÅ¾ky:
  - ğŸ”§ **MateriÃ¡l** - tabulka s tlaÄÃ­tky (PÅ™idat/Upravit/Smazat)
  - ğŸ‘· **PrÃ¡ce** - tabulka s tlaÄÃ­tky
  - ğŸšš **CizÃ­ vÃ½kon** - tabulka s tlaÄÃ­tky

- Tabulky obsahujÃ­:
  - NÃ¡zev poloÅ¾ky
  - MnoÅ¾stvÃ­
  - Jednotka
  - Cena/jedn.
  - Sleva %
  - Cena celkem
  - ID (skrytÃ©)

ğŸ“ **ZÃ¡loÅ¾ka 3: Dokumenty a fotky**
- Seznam dokumentÅ¯
- Seznam fotek
- TlaÄÃ­tka:
  - ğŸ“„ Importovat dokument
  - ğŸ“¸ Importovat fotku

**PRAVÃ PANEL - NÃ¡hled a akce:**
- ğŸ“‹ **ZakÃ¡zkovÃ½ list** â†’ otevÅ™e editor zakÃ¡zkovÃ©ho listu
- ğŸ“Š **Proforma** â†’ nÃ¡hled proformy s tiskem/PDF
- ğŸ§¾ **Faktura** â†’ vytvoÅ™enÃ­ faktury

**Funkce:**
- Proklik na zÃ¡kaznÃ­ka
- Proklik na motorku
- Import dokumentÅ¯ (PDF, Word, Excel)
- Import fotek (PNG, JPG, JPEG, BMP)
- AutomatickÃ½ pÅ™epoÄet ceny zakÃ¡zky

---

### **5. `order_items.py`** ğŸ“¦

**ÃšÄel:** Widget pro sprÃ¡vu poloÅ¾ek zakÃ¡zky (dÃ­ly, prÃ¡ce, ostatnÃ­)

**Obsahuje:**

**HlaviÄka:**
- ğŸ“¦ PoloÅ¾ky zakÃ¡zky
- TlaÄÃ­tka:
  - â• DÃ­l (zelenÃ©)
  - â• PrÃ¡ce (modrÃ©)
  - â• OstatnÃ­ (oranÅ¾ovÃ©)
  - ğŸ—‘ï¸ Smazat (ÄervenÃ©)

**Tabulka poloÅ¾ek:**
- Typ (DÃ­l, PrÃ¡ce, OstatnÃ­)
- NÃ¡zev
- MnoÅ¾stvÃ­
- Jednotka (ks, hod, m, l, kg, mÂ², set)
- Cena/jedn.
- DPH % (21%, 15%, 12%, 0%)
- Cena celkem (s DPH)
- ID (skrytÃ©)

**Souhrn:**
- CelkovÃ¡ cena s DPH
- CelkovÃ¡ cena bez DPH
- FormÃ¡tovÃ¡nÃ­ s oddÄ›lovaÄem tisÃ­cÅ¯

**Dialog pro pÅ™idÃ¡nÃ­/editaci poloÅ¾ky:**
- Typ poloÅ¾ky
- NÃ¡zev poloÅ¾ky *
- MnoÅ¾stvÃ­
- Jednotka (editovatelnÃ½ ComboBox)
- Cena/jedn. (bez DPH)
- Sazba DPH
- AutomatickÃ½ vÃ½poÄet:
  - Cena bez DPH
  - DPH ÄÃ¡stka
  - Cena s DPH (velkÃ¡, zelenÃ¡)

**Funkce:**
- Dvojklik pro editaci
- AutomatickÃ½ pÅ™epoÄet celkovÃ© ceny zakÃ¡zky
- BezpeÄnÃ© zaokrouhlovÃ¡nÃ­ (ochrana pÅ™ed floating point chybami)
- Kompatibilita se starÅ¡Ã­m DB schÃ©matem

---

### **6. `order_widgets.py`** ğŸ§©

**ÃšÄel:** PomocnÃ© dialogy a komponenty pro zakÃ¡zky

**Obsahuje:**

**ChangeStatusDialog** - Dialog pro zmÄ›nu stavu
- ZobrazenÃ­ aktuÃ¡lnÃ­ho stavu
- VÃ½bÄ›r novÃ©ho stavu (ComboBox)
- TlaÄÃ­tka: ZruÅ¡it / ZmÄ›nit
- Signal `status_changed` pro notifikaci

**OrderItemDialog** - Dialog pro pÅ™idÃ¡nÃ­/editaci poloÅ¾ky (profesionÃ¡lnÃ­)
- **Pro MateriÃ¡l:**
  - VÃ½bÄ›r ze skladu (ComboBox)
  - AutomatickÃ© vyplnÄ›nÃ­ ceny a jednotky
  - OdeÄet ze skladu pÅ™i uloÅ¾enÃ­

- **Pro PrÃ¡ce:**
  - VÃ½bÄ›r z ÄÃ­selnÃ­ku pracÃ­
  - TlaÄÃ­tko âš™ï¸ pro sprÃ¡vu ÄÃ­selnÃ­ku
  - HodinovÃ¡ sazba z ÄÃ­selnÃ­ku

- **Pro CizÃ­ vÃ½kon (zjednoduÅ¡enÃ½ formulÃ¡Å™):**
  - NÃ¡zev sluÅ¾by
  - NÃ¡kupnÃ­ cena
  - ProdejnÃ­ cena
  - Sleva %
  - AutomatickÃ½ vÃ½poÄet marÅ¾e
  - FinÃ¡lnÃ­ cena

- **SpoleÄnÃ©:**
  - NÃ¡zev poloÅ¾ky
  - MnoÅ¾stvÃ­
  - Jednotka
  - Cena bez DPH
  - DPH sazba
  - Sleva %
  - AutomatickÃ½ pÅ™epoÄet vÅ¡ech hodnot

**LaborTypesDialog** - SprÃ¡va ÄÃ­selnÃ­ku pracÃ­
- Tabulka pracÃ­ (NÃ¡zev, Cena/hod, AktivnÃ­)
- TlaÄÃ­tka: PÅ™idat / Upravit / Smazat
- Dvojklik pro editaci

**LaborTypeEditDialog** - Editace typu prÃ¡ce
- NÃ¡zev prÃ¡ce
- HodinovÃ¡ sazba (KÄ/hod)
- Checkbox AktivnÃ­
- CRUD operace v tabulce `codebook_repair_types`

---

### **7. `order_export.py`** ğŸ“¤

**ÃšÄel:** Export zakÃ¡zek do PDF - profesionÃ¡lnÃ­ verze

**Obsahuje:**

**OrderExporter tÅ™Ã­da:**

**Metody exportu:**
- `export_work_order()` - Export zakÃ¡zkovÃ©ho listu
- `export_proforma()` - Export proformy
- `export_invoice()` - Export faktury
- `export_work_order_with_data()` - Export s daty z editoru

**ZakÃ¡zkovÃ½ list obsahuje:**
- HlaviÄka (nÃ¡zev firmy, logo)
- ÄŒÃ­slo zakÃ¡zky, datum
- Ãšdaje o servisu
- Ãšdaje o zÃ¡kaznÃ­kovi
- Informace o vozidle (znaÄka, model, SPZ, VIN, km, barva)
- Stav PHM
- VÃ½bava vozidla / viditelnÃ¡ poÅ¡kozenÃ­
- Popis pracÃ­ / poÅ¾adavky zÃ¡kaznÃ­ka
- Prostor pro rozÅ¡Ã­Å™enÃ­ zakÃ¡zky
- PÅ™edbÄ›Å¾nÃ½ termÃ­n dokonÄenÃ­
- Odhad ceny vÄ. DPH
- Podpisy (servisnÃ­ poradce, zÃ¡kaznÃ­k)
- PatiÄka (datum vytiÅ¡tÄ›nÃ­, upozornÄ›nÃ­)

**Proforma obsahuje:**
- HlaviÄka
- ÄŒÃ­slo zakÃ¡zky, datum
- Ãšdaje zÃ¡kaznÃ­ka
- Vozidlo
- Tabulka poloÅ¾ek (Popis, MnoÅ¾stvÃ­, Cena/jedn., Celkem)
- CelkovÃ¡ cena
- Platnost nabÃ­dky (14 dnÃ­)

**Faktura obsahuje:**
- ÄŒÃ­slo faktury (automaticky generovanÃ©)
- Dodavatel (nastavenÃ­ firmy)
- OdbÄ›ratel (zÃ¡kaznÃ­k)
- Tabulka poloÅ¾ek s DPH
- Rekapitulace DPH
- CelkovÃ¡ cena
- BankovnÃ­ spojenÃ­
- QR kÃ³d pro platbu

**Funkce:**
- Registrace fontÅ¯ pro ÄeÅ¡tinu (DejaVu)
- AutomatickÃ© otevÅ™enÃ­ PDF po exportu
- Dialog pro vÃ½bÄ›r umÃ­stÄ›nÃ­ souboru
- FormÃ¡tovÃ¡nÃ­ adres
- GenerovÃ¡nÃ­ ÄÃ­sla faktury
- NastavenÃ­ firmy z databÃ¡ze

---

### **8. `order_analytics.py`** ğŸ“Š

**ÃšÄel:** AnalÃ½zy a statistiky zakÃ¡zek

**Obsahuje:**

**HlaviÄka:**
- ğŸ“Š AnalÃ½zy zakÃ¡zek
- Filtr obdobÃ­ (ComboBox):
  - Tento mÄ›sÃ­c
  - PoslednÃ­ 3 mÄ›sÃ­ce
  - PoslednÃ­ 6 mÄ›sÃ­cÅ¯
  - Tento rok
  - VÅ¡e
- ğŸ”„ TlaÄÃ­tko Obnovit

**StatistickÃ© boxy (barevnÃ© karty):**
- ğŸ“‹ Celkem zakÃ¡zek (modrÃ¡)
- ğŸ”„ AktivnÃ­ zakÃ¡zky (oranÅ¾ovÃ¡)
- âœ… DokonÄenÃ© (zelenÃ¡)
- ğŸ’° CelkovÃ½ obrat (tyrkysovÃ¡)
- ğŸ“Š PrÅ¯mÄ›rnÃ¡ cena zakÃ¡zky (fialovÃ¡)
- â³ ÄŒekÃ¡ na dÃ­ly (oranÅ¾ovÃ¡)

**Tabulky:**
- **ZakÃ¡zky podle typu:**
  - Typ (ZakÃ¡zka, VolnÃ½ prodej, NabÃ­dka...)
  - PoÄet
  - Obrat

- **ZakÃ¡zky podle stavu:**
  - Stav (barevnÃ½ badge)
  - PoÄet
  - Obrat

- **Top 10 zÃ¡kaznÃ­kÅ¯:**
  - JmÃ©no zÃ¡kaznÃ­ka
  - PoÄet zakÃ¡zek
  - CelkovÃ½ obrat

**Funkce:**
- AutomatickÃ© naÄÃ­tÃ¡nÃ­ pÅ™i zmÄ›nÄ› filtru
- SQL agregace podle obdobÃ­
- BarevnÃ© zvÃ½raznÄ›nÃ­ stavÅ¯
- FormÃ¡tovÃ¡nÃ­ cen s oddÄ›lovaÄi

---

### **9. `order_preview.py`** ğŸ‘ï¸

**ÃšÄel:** NÃ¡hled dokumentÅ¯ pÅ™ed tiskem (proforma)

**Obsahuje:**

**ProformaPreviewDialog:**
- HlaviÄka "ğŸ“‹ NÃ¡hled proformy"
- HTML nÃ¡hled v QTextBrowser
- ProfesionÃ¡lnÃ­ vzhled (CSS styling)
- TlaÄÃ­tka:
  - ZavÅ™Ã­t
  - ğŸ–¨ï¸ Vytisknout (modrÃ©)
  - ğŸ’¾ UloÅ¾it jako PDF (zelenÃ©)

**Obsah nÃ¡hledu:**
- ÄŒÃ­slo zakÃ¡zky
- Datum
- ZÃ¡kaznÃ­k (jmÃ©no, adresa, telefon)
- Vozidlo
- Tabulka poloÅ¾ek
- CelkovÃ¡ cena
- Platnost nabÃ­dky

**Funkce:**
- Tisk pÅ™es QPrinter/QPrintDialog
- Export do PDF pÅ™es order_export
- AutomatickÃ© formÃ¡tovÃ¡nÃ­ HTML
- ResponzivnÃ­ zobrazenÃ­

---

### **10. `order_work_order_editor.py`** âœï¸

**ÃšÄel:** Editor zakÃ¡zkovÃ©ho listu pÅ™ed tiskem

**Obsahuje:**

**HlaviÄka:**
- ğŸ“„ ZakÃ¡zkovÃ½ list - Ãºprava pÅ™ed tiskem

**ScrollovatelnÃ½ formulÃ¡Å™:**

**ZÃ¡kladnÃ­ Ãºdaje (read-only):**
- ÄŒÃ­slo zakÃ¡zky
- ZÃ¡kaznÃ­k
- Vozidlo

**TermÃ­ny:**
- Datum pÅ™Ã­jmu (DateEdit s kalendÃ¡Å™em)
- PÅ™edbÄ›Å¾nÃ½ termÃ­n dokonÄenÃ­

**Stav vozidla pÅ™i pÅ™Ã­jmu:**
- Stav PHM (napÅ™. 1/2, 3/4, plnÃ¡)
- Stav km (tachometr)
- VÃ½bava vozidla / viditelnÃ¡ poÅ¡kozenÃ­ (TextEdit)

**Popis pracÃ­ / poÅ¾adavky zÃ¡kaznÃ­ka:**
- Automaticky vyplnÄ›no poloÅ¾kami ze zakÃ¡zky
- EditovatelnÃ© (velkÃ© TextEdit)
- FormÃ¡tovÃ¡nÃ­ podle typu poloÅ¾ek (=== MATERIÃL ===, === PRÃCE ===)

**RozÅ¡Ã­Å™enÃ­ zakÃ¡zky / vyjÃ¡dÅ™enÃ­ opravny:**
- Prostor pro dodateÄnÃ© prÃ¡ce
- PrÃ¡zdnÃ© Å™Ã¡dky pro ruÄnÃ­ doplnÄ›nÃ­

**PÅ™edbÄ›Å¾nÃ¡ cena:**
- Odhad ceny vÄ. DPH
- Checkbox "PouÅ¾Ã­t cenu ze zakÃ¡zky"
- MoÅ¾nost ruÄnÃ­ho zadÃ¡nÃ­

**DodateÄnÃ© poznÃ¡mky:**
- TextEdit pro dalÅ¡Ã­ poznÃ¡mky

**TlaÄÃ­tka:**
- ZruÅ¡it
- ğŸ‘ï¸ NÃ¡hled (modrÃ©)
- ğŸ–¨ï¸ Vytisknout / UloÅ¾it PDF (zelenÃ©)

**Funkce:**
- AutomatickÃ© vyplnÄ›nÃ­ z dat zakÃ¡zky
- SkupinovÃ¡nÃ­ poloÅ¾ek podle typu
- PropojenÃ­ s order_export

---

### **11. `order_work_order_preview.py`** ğŸ”

**ÃšÄel:** NÃ¡hled zakÃ¡zkovÃ©ho listu pÅ™ed finÃ¡lnÃ­m tiskem

**Obsahuje:**

**HlaviÄka:**
- ğŸ“„ NÃ¡hled zakÃ¡zkovÃ©ho listu

**HTML nÃ¡hled:**
- ZAKÃZKOVÃ LIST (velkÃ½ nadpis)
- ÄŒÃ­slo zakÃ¡zky, datum pÅ™Ã­jmu, termÃ­n dokonÄenÃ­
- ZÃ¡kaznÃ­k
- Vozidlo
- Stav vozidla (PHM, km, vÃ½bava)
- Popis pracÃ­ (monospace font, white-space: pre-wrap)
- RozÅ¡Ã­Å™enÃ­ zakÃ¡zky (Å¾lutÃ½ box)
- PÅ™edbÄ›Å¾nÃ¡ cena (velkÃ¡, zelenÃ¡)
- PoznÃ¡mky

**TlaÄÃ­tka:**
- ZavÅ™Ã­t
- âœï¸ Upravit (modrÃ©) â†’ vracÃ­ se k editoru

**Funkce:**
- Live preview pÅ™ed tiskem
- BarevnÃ© zvÃ½raznÄ›nÃ­ sekcÃ­
- ProfesionÃ¡lnÃ­ CSS styling
- MoÅ¾nost nÃ¡vratu k ÃºpravÃ¡m

---

## ğŸ¨ VIZUALIZACE STRUKTURY

```
ğŸ“‹ MODUL ZAKÃZKY
â”‚
â”œâ”€ ğŸ“‹ Seznam zakÃ¡zek (hlavnÃ­ view)
â”‚  â”œâ”€ ğŸ“Š RychlÃ© statistiky (celkem, aktivnÃ­, rozpracovanÃ©...)
â”‚  â”œâ”€ ğŸ” Filtry (vyhledÃ¡vÃ¡nÃ­, typ, stav)
â”‚  â”œâ”€ ğŸ“‘ Tabulka zakÃ¡zek
â”‚  â”‚  â”œâ”€ BarevnÃ© stavy
â”‚  â”‚  â”œâ”€ Dvojklik â†’ detail
â”‚  â”‚  â””â”€ PravÃ½ klik â†’ kontextovÃ© menu
â”‚  â”œâ”€ â• TlaÄÃ­tka rychlÃ©ho vytvoÅ™enÃ­
â”‚  â”‚  â”œâ”€ NovÃ¡ zakÃ¡zka
â”‚  â”‚  â”œâ”€ VolnÃ½ prodej
â”‚  â”‚  â””â”€ NabÃ­dka
â”‚  â””â”€ ğŸ”„ Reset filtrÅ¯
â”‚
â”œâ”€ ğŸ“ FormulÃ¡Å™ zakÃ¡zky
â”‚  â”œâ”€ Typ a stav
â”‚  â”œâ”€ ğŸ” VyhledÃ¡nÃ­ motorky dle SPZ
â”‚  â”œâ”€ ğŸï¸ Info o motorce (automaticky)
â”‚  â”œâ”€ ğŸ‘¤ Info o zÃ¡kaznÃ­kovi (automaticky)
â”‚  â””â”€ ğŸ“ PoznÃ¡mka
â”‚
â”œâ”€ ğŸ“Š Detail zakÃ¡zky (velkÃ© okno)
â”‚  â”œâ”€ âš¡ AkÄnÃ­ liÅ¡ta (kompaktnÃ­)
â”‚  â”‚  â”œâ”€ ÄŒÃ­slo zakÃ¡zky
â”‚  â”‚  â”œâ”€ Badge stavu
â”‚  â”‚  â”œâ”€ ğŸ’° AktuÃ¡lnÃ­ cena
â”‚  â”‚  â”œâ”€ ZmÄ›nit stav
â”‚  â”‚  â”œâ”€ âœ“ UloÅ¾it
â”‚  â”‚  â””â”€ âœ• Smazat
â”‚  â”‚
â”‚  â”œâ”€ ğŸ“‹ ZÃ¡loÅ¾ka: ZÃ¡kladnÃ­ informace
â”‚  â”‚  â”œâ”€ ğŸ‘¤ ZÃ¡kaznÃ­k (proklik)
â”‚  â”‚  â”œâ”€ ğŸ§¾ FakturaÄnÃ­ Ãºdaje
â”‚  â”‚  â”œâ”€ ğŸï¸ Motorka (proklik)
â”‚  â”‚  â””â”€ ğŸ“ PoznÃ¡mky
â”‚  â”‚
â”‚  â”œâ”€ ğŸ“¦ ZÃ¡loÅ¾ka: PoloÅ¾ky zakÃ¡zky
â”‚  â”‚  â”œâ”€ ğŸ”§ MateriÃ¡l
â”‚  â”‚  â”‚  â”œâ”€ Ze skladu
â”‚  â”‚  â”‚  â””â”€ RuÄnÃ­ zadÃ¡nÃ­
â”‚  â”‚  â”œâ”€ ğŸ‘· PrÃ¡ce
â”‚  â”‚  â”‚  â”œâ”€ Z ÄÃ­selnÃ­ku
â”‚  â”‚  â”‚  â””â”€ HodinovÃ¡ sazba
â”‚  â”‚  â””â”€ ğŸšš CizÃ­ vÃ½kon
â”‚  â”‚     â”œâ”€ NÃ¡kupnÃ­ cena
â”‚  â”‚     â”œâ”€ ProdejnÃ­ cena
â”‚  â”‚     â””â”€ MarÅ¾e
â”‚  â”‚
â”‚  â”œâ”€ ğŸ“ ZÃ¡loÅ¾ka: Dokumenty a fotky
â”‚  â”‚  â”œâ”€ ğŸ“„ Import dokumentÅ¯
â”‚  â”‚  â””â”€ ğŸ“¸ Import fotek
â”‚  â”‚
â”‚  â””â”€ ğŸ–¨ï¸ Panel dokumentÅ¯
â”‚     â”œâ”€ ğŸ“‹ ZakÃ¡zkovÃ½ list
â”‚     â”œâ”€ ğŸ“Š Proforma
â”‚     â””â”€ ğŸ§¾ Faktura
â”‚
â”œâ”€ ğŸ“„ Editor zakÃ¡zkovÃ©ho listu
â”‚  â”œâ”€ ğŸ“… TermÃ­ny (pÅ™Ã­jem, dokonÄenÃ­)
â”‚  â”œâ”€ ğŸš— Stav vozidla (PHM, km, vÃ½bava)
â”‚  â”œâ”€ ğŸ”§ Popis pracÃ­ (z poloÅ¾ek)
â”‚  â”œâ”€ ğŸ“ RozÅ¡Ã­Å™enÃ­ zakÃ¡zky
â”‚  â”œâ”€ ğŸ’° PÅ™edbÄ›Å¾nÃ¡ cena
â”‚  â”œâ”€ ğŸ‘ï¸ NÃ¡hled
â”‚  â””â”€ ğŸ–¨ï¸ Tisk/PDF
â”‚
â”œâ”€ ğŸ“¤ Export dokumentÅ¯ (PDF)
â”‚  â”œâ”€ ğŸ“‹ ZakÃ¡zkovÃ½ list
â”‚  â”‚  â”œâ”€ KompletnÃ­ info
â”‚  â”‚  â”œâ”€ Podpisy
â”‚  â”‚  â””â”€ ProfesionÃ¡lnÃ­ vzhled
â”‚  â”œâ”€ ğŸ“Š Proforma
â”‚  â”‚  â”œâ”€ CenovÃ¡ nabÃ­dka
â”‚  â”‚  â”œâ”€ Tabulka poloÅ¾ek
â”‚  â”‚  â””â”€ Platnost 14 dnÃ­
â”‚  â””â”€ ğŸ§¾ Faktura
â”‚     â”œâ”€ Dodavatel/OdbÄ›ratel
â”‚     â”œâ”€ PoloÅ¾ky s DPH
â”‚     â”œâ”€ Rekapitulace
â”‚     â””â”€ QR kÃ³d
â”‚
â””â”€ ğŸ“Š AnalÃ½zy
   â”œâ”€ ğŸ“ˆ StatistickÃ© karty
   â”œâ”€ ğŸ“‹ ZakÃ¡zky podle typu
   â”œâ”€ ğŸ“Š ZakÃ¡zky podle stavu
   â””â”€ ğŸ† Top 10 zÃ¡kaznÃ­kÅ¯
```

---

## ğŸ”— PROPOJENÃ S OSTATNÃMI MODULY

**ZÃ¡kaznÃ­ci (module_customers):**
- Proklik z detailu zakÃ¡zky na zÃ¡kaznÃ­ka
- AutomatickÃ© naÄtenÃ­ zÃ¡kaznÃ­ka z motorky
- FakturaÄnÃ­ Ãºdaje zÃ¡kaznÃ­ka

**Motorky/Vozidla (module_vehicles):**
- VyhledÃ¡nÃ­ motorky podle SPZ
- Proklik z detailu zakÃ¡zky na motorku
- VytvoÅ™enÃ­ novÃ© motorky pÅ™Ã­mo z formulÃ¡Å™e zakÃ¡zky

**Sklad (warehouse):**
- VÃ½bÄ›r materiÃ¡lu ze skladu
- AutomatickÃ½ odpoÄet mnoÅ¾stvÃ­
- NÃ¡kupnÃ­/prodejnÃ­ ceny

**ÄŒÃ­selnÃ­ky (codebooks):**
- Typy pracÃ­ a hodinovÃ© sazby
- Typy zakÃ¡zek a stavy
- MÄ›rnÃ© jednotky
- Sazby DPH

**Administrativa (module_administration):**
- Export faktur
- NastavenÃ­ firmy (logo, kontakty, IÄŒO, DIÄŒ)
- ÄŒÃ­selnÃ© Å™ady dokumentÅ¯

---

## ğŸ’¾ DATABÃZOVÃ‰ TABULKY

**orders** - HlavnÃ­ tabulka zakÃ¡zek
```sql
- id (PK)
- order_number (unikÃ¡tnÃ­ ÄÃ­slo)
- order_type (typ zakÃ¡zky)
- status (stav)
- customer_id (FK â†’ customers)
- vehicle_id (FK â†’ vehicles)
- created_date
- completed_date
- note
- total_price
```

**order_items** - PoloÅ¾ky zakÃ¡zky
```sql
- id (PK)
- order_id (FK â†’ orders)
- warehouse_id (FK â†’ warehouse, nullable)
- item_type (DÃ­l/PrÃ¡ce/OstatnÃ­/MateriÃ¡l/CizÃ­ vÃ½kon)
- name / item_name (kompatibilita)
- quantity
- unit
- unit_price
- vat_rate
- total_price
- created_at
```

**codebook_repair_types** - ÄŒÃ­selnÃ­k pracÃ­
```sql
- id (PK)
- name (nÃ¡zev prÃ¡ce)
- price (hodinovÃ¡ sazba)
- active (aktivnÃ­ ano/ne)
```

---

## âš™ï¸ KONFIGURACE (config.py)

```python
# Typy zakÃ¡zek
ORDER_TYPES = ["ZakÃ¡zka", "VolnÃ½ prodej", "NabÃ­dka", "Garance", "Reklamace"]

# Stavy zakÃ¡zek
ORDER_STATUSES = ["V pÅ™Ã­pravÄ›", "OtevÅ™enÃ¡", "RozpracovanÃ¡", "ÄŒekÃ¡ na dÃ­ly", "HotovÃ¡", "Archiv"]

# Barvy stavÅ¯
ORDER_STATUS_COLORS = {
    "V pÅ™Ã­pravÄ›": "#95a5a6",      # Å¡edÃ¡
    "OtevÅ™enÃ¡": "#3498db",         # modrÃ¡
    "RozpracovanÃ¡": "#f39c12",     # oranÅ¾ovÃ¡
    "ÄŒekÃ¡ na dÃ­ly": "#e67e22",     # tmavÄ› oranÅ¾ovÃ¡
    "HotovÃ¡": "#27ae60",           # zelenÃ¡
    "Archiv": "#7f8c8d"            # tmavÄ› Å¡edÃ¡
}

# Barvy aplikace
COLOR_PRIMARY = "#2c3e50"
COLOR_SUCCESS = "#27ae60"
COLOR_DANGER = "#e74c3c"
COLOR_WARNING = "#f39c12"
COLOR_SECONDARY = "#3498db"
```

---

## ğŸš€ KLÃÄŒOVÃ‰ VLASTNOSTI MODULU

1. **KompletnÃ­ workflow zakÃ¡zky** - od vytvoÅ™enÃ­ po fakturaci
2. **InteligentnÃ­ vyhledÃ¡vÃ¡nÃ­** - podle SPZ automaticky naÄte motorku i zÃ¡kaznÃ­ka
3. **ProfesionÃ¡lnÃ­ dokumenty** - zakÃ¡zkovÃ½ list, proforma, faktura v PDF
4. **FlexibilnÃ­ poloÅ¾ky** - materiÃ¡l ze skladu, prÃ¡ce z ÄÃ­selnÃ­ku, cizÃ­ vÃ½kony
5. **Å½ivÃ© statistiky** - pÅ™ehledy a analÃ½zy v reÃ¡lnÃ©m Äase
6. **SprÃ¡va DPH** - automatickÃ½ vÃ½poÄet, rÅ¯znÃ© sazby
7. **BarevnÃ© stavy** - vizuÃ¡lnÃ­ rozliÅ¡enÃ­ stavu zakÃ¡zek
8. **ProklikÃ¡vÃ¡nÃ­** - snadnÃ¡ navigace mezi zÃ¡kaznÃ­kem, motorkou a zakÃ¡zkou
9. **Historie** - kompletnÃ­ audit trail zmÄ›n
10. **ResponzivnÃ­ UI** - profesionÃ¡lnÃ­ vzhled, optimalizovÃ¡no pro produktivitu
